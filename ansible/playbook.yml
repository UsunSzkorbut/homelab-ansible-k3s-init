---
- name: K3s Server Install
  hosts: server
  become: true
  vars:
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no'
  module_defaults:
    ansible.builtin.setup:
      gather_timeout: 60
  roles:
    - k3s-server

- name: K3s Agents Install
  hosts: agents
  become: true
  vars:
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no'
  roles:
    - k3s-agents

- name: K3s Components Install
  hosts: server
  become: true
  vars:
    ansible_ssh_common_args: '-o StrictHostKeyChecking=no'
  roles:
    - k3s-components